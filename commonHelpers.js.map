{"version":3,"file":"commonHelpers.js","sources":["../src/js/refs.js","../src/js/variables.js","../src/js/functions.js","../src/main.js"],"sourcesContent":["export default {\n  button: document.querySelector('.button'), // витягуємо елемент кнопки\n  countSpan: document.querySelector('#count'), // витягуємо елемент спану\n};\n","const axiosURL = 'https://668581e2b3f57b06dd4cf9fd.mockapi.io/api/v1'; //задаємо базову адресу нашого бекенду для аксіос\nconst LS_KEY = 'UserID'; //задаємо ключ для локал сторедж\n\nexport { axiosURL, LS_KEY };\n","import axios from 'axios';\nimport elements from './refs'; // витягуємо елементи кнопки та спану в змінну\nimport { axiosURL, LS_KEY } from './variables';\n\naxios.defaults.baseURL = axiosURL; //задаємо базову адресу нашого бекенду для аксіос\n\nfunction addBablo(user) {\n  // створюємо функцію для обробки кліку по кнопці, приймаємо об'єкт юзера і посилання на спан у змінну element\n  elements.button.disabled = true; //блокуємо кнопку\n  elements.button.innerHTML =\n    '<span class=\"loader\"></span>&nbsp;&nbsp;&nbsp;Нарахування бабла...'; //змінюємо текст кнопки і додаємо спіннер\n  setTimeout(() => {\n    // Імітуємо затримку відповіді бекенду\n    user.bablo += 1; // збільшуємо значення бабла у об'єкта юзера на 1\n    axios\n      .put(`user/${user.userID}`, user) // змінюємо значення бабла у юзера на бекенді (нажаль, mockapi не приймає метод PATCH, тому використовуємо PUT і скидаємо весь об'єкт)\n      .then(function () {\n        elements.countSpan.innerHTML = user.bablo.toString(); // якщо успішно змінилось значення бабла на бекенді, то змінюємо значення і у спанчику на фронтенді\n      })\n      .catch(function (error) {\n        console.log(error);\n      })\n      .finally(() => {\n        elements.button.innerHTML = 'Бабло!'; //Повертаємо значення кнопки\n        elements.button.disabled = false; //Розблокуємо кнопку\n      });\n  }, Math.random() * 3000); // Рандомна затримка до 3 секунд\n}\nfunction startFromScratch(user) {\n  axios\n    .post('user', { bablo: 0 }) // створюємо нового юзера на бекенді\n    .then(function (response) {\n      user.userID = Number(response.data.userID); // в об'єкт юзера заносимо його новостворений ІД у числовому форматі\n      user.bablo = 0; // обнуляємо кількість бабла у об'єкті юзера\n      elements.countSpan.innerHTML = '0'; //обнуляємо кількість бабла на сторінці\n      localStorage.setItem(LS_KEY, JSON.stringify(user.userID)); // зберігаємо ІД юзера у ЛС\n    })\n    .catch(function (error) {\n      console.log(error);\n    });\n}\n\nexport { addBablo, startFromScratch };\n","import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { addBablo, startFromScratch } from './js/functions'; // імпортуємо функцію прослуховувача\nimport elements from './js/refs'; // витягуємо елементи кнопки та спану в змінну\nimport { axiosURL, LS_KEY } from './js/variables';\n\naxios.defaults.baseURL = axiosURL; //задаємо базову адресу нашого бекенду для аксіос\n\nconst user = { bablo: 0 }; // створюємо об'єкт юзера з дефолтними даними\nconst savedData = localStorage.getItem(LS_KEY); // дістаємо значення із стореджу\n\nif (savedData === null) {\n  //якщо сторедж пустий, то ...\n  axios\n    .post('user', user) // створюємо нового юзера на бекенді\n    .then(function (response) {\n      user.userID = Number(response.data.userID); // в об'єкт юзера заносимо його новостворений ІД у числовому форматі\n      localStorage.setItem(LS_KEY, JSON.stringify(user.userID)); // зберігаємо ІД юзера у ЛС\n    })\n    .catch(function (error) {\n      console.log(error);\n    });\n} else {\n  // якщо сторедж не пустий, то ...\n  user.userID = Number(savedData); //в об'єкт юзера заносимо його ІД з ЛС\n  axios\n    .get(`user/${user.userID}`) // здійснюємо запит на бекенд по ІД юзера\n    .then(function (response) {\n      console.log(response);\n      user.bablo = response.data.bablo; // в об'єкт юзера записуємо кількість його бабла\n      elements.countSpan.innerHTML = user.bablo.toString(); // змінюємо контент спану на кількість бабла в об'єкті юзера\n    })\n    .catch(function (error) {\n      // Оброблюємо помилку\n      console.log(error);\n      if (error.response && error.response.status === 404) {\n        //робимо перевірку на наявність 404 помилки(коли юзера не існує на бекенді)\n        startFromScratch(user); //викликаємо функцію для створення нового юзера\n      } else {\n        // виводимо помилку\n        iziToast.error({\n          title: 'Помилка',\n          message: `Виникла помилка при запиті Ваших даних з серверу. Спробуйте пізніше`,\n          position: 'topRight',\n        });\n      }\n    });\n}\n\nelements.button.addEventListener('click', () => {\n  // додаємо прослуховувач по кліку\n  addBablo(user); // викликаємо функцію для обробки кліку\n});\n"],"names":["elements","axiosURL","LS_KEY","axios","addBablo","user","error","startFromScratch","response","savedData","iziToast"],"mappings":"6vBAAA,MAAeA,EAAA,CACb,OAAQ,SAAS,cAAc,SAAS,EACxC,UAAW,SAAS,cAAc,QAAQ,CAC5C,ECHMC,EAAW,qDACXC,EAAS,SCGfC,EAAM,SAAS,QAAUF,EAEzB,SAASG,EAASC,EAAM,CAEtBL,EAAS,OAAO,SAAW,GAC3BA,EAAS,OAAO,UACd,qEACF,WAAW,IAAM,CAEfK,EAAK,OAAS,EACdF,EACG,IAAI,QAAQE,EAAK,MAAM,GAAIA,CAAI,EAC/B,KAAK,UAAY,CAChBL,EAAS,UAAU,UAAYK,EAAK,MAAM,SAAQ,CAC1D,CAAO,EACA,MAAM,SAAUC,EAAO,CACtB,QAAQ,IAAIA,CAAK,CACzB,CAAO,EACA,QAAQ,IAAM,CACbN,EAAS,OAAO,UAAY,SAC5BA,EAAS,OAAO,SAAW,EACnC,CAAO,CACJ,EAAE,KAAK,SAAW,GAAI,CACzB,CACA,SAASO,EAAiBF,EAAM,CAC9BF,EACG,KAAK,OAAQ,CAAE,MAAO,CAAC,CAAE,EACzB,KAAK,SAAUK,EAAU,CACxBH,EAAK,OAAS,OAAOG,EAAS,KAAK,MAAM,EACzCH,EAAK,MAAQ,EACbL,EAAS,UAAU,UAAY,IAC/B,aAAa,QAAQE,EAAQ,KAAK,UAAUG,EAAK,MAAM,CAAC,CAC9D,CAAK,EACA,MAAM,SAAUC,EAAO,CACtB,QAAQ,IAAIA,CAAK,CACvB,CAAK,CACL,CCjCAH,EAAM,SAAS,QAAUF,EAEzB,MAAMI,EAAO,CAAE,MAAO,GAChBI,EAAY,aAAa,QAAQP,CAAM,EAEzCO,IAAc,KAEhBN,EACG,KAAK,OAAQE,CAAI,EACjB,KAAK,SAAUG,EAAU,CACxBH,EAAK,OAAS,OAAOG,EAAS,KAAK,MAAM,EACzC,aAAa,QAAQN,EAAQ,KAAK,UAAUG,EAAK,MAAM,CAAC,CAC9D,CAAK,EACA,MAAM,SAAUC,EAAO,CACtB,QAAQ,IAAIA,CAAK,CACvB,CAAK,GAGHD,EAAK,OAAS,OAAOI,CAAS,EAC9BN,EACG,IAAI,QAAQE,EAAK,MAAM,EAAE,EACzB,KAAK,SAAUG,EAAU,CACxB,QAAQ,IAAIA,CAAQ,EACpBH,EAAK,MAAQG,EAAS,KAAK,MAC3BR,EAAS,UAAU,UAAYK,EAAK,MAAM,SAAQ,CACxD,CAAK,EACA,MAAM,SAAUC,EAAO,CAEtB,QAAQ,IAAIA,CAAK,EACbA,EAAM,UAAYA,EAAM,SAAS,SAAW,IAE9CC,EAAiBF,CAAI,EAGrBK,EAAS,MAAM,CACb,MAAO,UACP,QAAS,sEACT,SAAU,UACpB,CAAS,CAET,CAAK,GAGLV,EAAS,OAAO,iBAAiB,QAAS,IAAM,CAE9CI,EAASC,CAAI,CACf,CAAC"}